{ # this ensures the entire script is downloaded #

# FUNCTION FOR INSTALLING NODE + RELATED
# ###################################################################
install_node() {
  sudo apt-get install build-essential -y

  hash bar || { curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash; }
  export NVM_DIR="/home/rfrankel/.nvm"
  [ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm \
  nvm install node 
  nvm use node
  nvm alias default node

  # Node make tools
  npm install -g node-gyp

  # Using trash instead of rm
  npm install -g trash-cli
}

# FUNCTION FOR COMMAND LINE 
# ###################################################################
install_cli() {
  if [ ! -d ~/code/z ]; then
    git clone https://github.com/rupa/z.git ~/code/z
  fi

  rm -f ~/.z
  ln -sf ~/dotfiles/z/.z ~/.z
}

# FUNCTION FOR INSTALLING VIM
# ###################################################################
install_vim() {
   # Delete Existing
   rm -rf ~/.vimrc
   rm -rf ~/.vim/snippets

   # Symlink New
   ln -s ~/dotfiles/vimrc/.vimrc ~/.vimrc
   ln -s ~/dotfiles/vimrc/snippets ~/.vim/snippets 

   # Install Vundle if Needed
   sudo apt-get install curl vim -y
   if [ ! -d ~/.vim/bundle/vundle/ ]; then
     git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle
   fi

   # Create colors directory
   if [ ! -d ~/.vim/colors ]; then
     mkdir ~/.vim/colors
   fi

   # Download VIM theme
   if [ ! -f ~/.vim/colors/wombat256mod.vim ]; then
     curl -L http://www.vim.org/scripts/download_script.php?src_id=13400 > ~/.vim/colors/wombat256mod.vim
   fi

   # Install bundles
   vim - -i NONE -c VundleUpdate -c quitall
} #install_vim()

# FUNCTION FOR INSTALLING BASH
# ###################################################################
function install_bash() {
   #DELETE EXISTING .bashrc IF THERE IS ONE
   rm -rf ~/.bashrc &> /dev/null
   rm -rf ~/.bash_profile &> /dev/null

   #SYM LINK NEW .bashrc FILE
   ln -s ~/dotfiles/bashrc/.bashrc ~/.bashrc
   ln -s ~/dotfiles/bashrc/.bashrc ~/.bash_profile

   #MAKE LOCAL .bash_site_aliases
   #touch ~/.bash_site_aliases

   #RELOAD .bashrc
   source ~/.bashrc
}


# ###################################################################
# ###################################################################
# MAIN
# ###################################################################
# ###################################################################
if [ ! -d ~/dotfiles ]; then
   git clone https://github.com/ryan-frankel/dotfiles ~/dotfiles
   cd ~/dotfiles
else
   cd ~/dotfiles
   git pull origin master
fi

#install_node
install_cli
install_vim
install_bash

} # this ensures the entire script is downloaded #
